---
# PostgreSQL 16 STIG - Role Defaults
# Generated from Crunchy Data PostgreSQL 16 STIG

# PostgreSQL configuration paths
postgresql_version: "16"
postgresql_data_dir: "/var/lib/pgsql/16/data"
postgresql_conf_path: "{{ postgresql_data_dir }}/postgresql.conf"
postgresql_hba_path: "{{ postgresql_data_dir }}/pg_hba.conf"
postgresql_log_dir: "{{ postgresql_data_dir }}/log"
postgresql_service_name: "postgresql-16"
postgresql_user: "postgres"
postgresql_group: "postgres"
postgresql_ssl_cert_file: "/var/lib/pgsql/16/data/server.crt"
postgresql_ssl_key_file: "/var/lib/pgsql/16/data/server.key"
postgresql_ssl_ca_file: "/var/lib/pgsql/16/data/root.crt"
postgresql_ssl_crl_file: "/var/lib/pgsql/16/data/root.crl"

# STIG organization-defined values (override for site policy)
postgresql_stig_max_connections: 10
postgresql_stig_listen_addresses: "10.0.0.1, 127.0.0.1"
postgresql_stig_statement_timeout_ms: 10000
postgresql_stig_tcp_keepalives_idle: 10
postgresql_stig_tcp_keepalives_interval: 10
postgresql_stig_tcp_keepalives_count: 10
postgresql_stig_log_line_prefix: "< %m %a %u %d %r %p %c %e >"
postgresql_stig_pgaudit_log: "ddl, role, read, write"
# Include any site-required preload libraries in addition to pgaudit.
postgresql_stig_shared_preload_libraries: "pgaudit"
# Set to false to skip all manual-review debug tasks.
postgresql_stig_enable_manual_review_tasks: true

# STIG Rule Toggles
# Set to false to skip individual rules


# --- CAT II Rules ---
# CD16-00-000100 - PostgreSQL must limit the number of concurrent sessions to an organization-defined numb...
CD16_00_000100: true

# --- CAT I Rules ---
# CD16-00-000200 - PostgreSQL must integrate with an organization-level authentication/access mechanism pr...
CD16_00_000200: true
# CD16-00-000300 - PostgreSQL must enforce approved authorizations for logical access to information and s...
CD16_00_000300: true

# --- CAT II Rules ---
# CD16-00-000400 - PostgreSQL must protect against a user falsely repudiating having performed organizatio...
CD16_00_000400: true
# CD16-00-000500 - PostgreSQL must provide audit record generation capability for DOD-defined auditable ev...
CD16_00_000500: true
# CD16-00-000600 - PostgreSQL must allow only the information system security manager (ISSM), or individua...
CD16_00_000600: true
# CD16-00-000700 - PostgreSQL must be able to generate audit records when privileges/permissions are retri...
CD16_00_000700: true
# CD16-00-000800 - PostgreSQL must generate audit records when unsuccessful attempts to retrieve privilege...
CD16_00_000800: true
# CD16-00-000900 - PostgreSQL must initiate session auditing upon startup.
CD16_00_000900: true
# CD16-00-001000 - PostgreSQL must produce audit records containing sufficient information to establish wh...
CD16_00_001000: true
# CD16-00-001100 - PostgreSQL must produce audit records containing time stamps to establish when the even...
CD16_00_001100: true
# CD16-00-001200 - PostgreSQL must produce audit records containing sufficient information to establish wh...
CD16_00_001200: true
# CD16-00-001300 - PostgreSQL must produce audit records containing sufficient information to establish th...
CD16_00_001300: true
# CD16-00-001400 - PostgreSQL must produce audit records containing sufficient information to establish th...
CD16_00_001400: true
# CD16-00-001500 - PostgreSQL must produce audit records containing sufficient information to establish th...
CD16_00_001500: true
# CD16-00-001600 - PostgreSQL must include additional, more detailed, organization-defined information in ...
CD16_00_001600: true
# CD16-00-001700 - PostgreSQL must, by default, shut down upon audit failure, to include the unavailabilit...
CD16_00_001700: true
# CD16-00-001800 - PostgreSQL must be configurable to overwrite audit log records, oldest first (first-in-...
CD16_00_001800: true
# CD16-00-002000 - The audit information produced by PostgreSQL must be protected from unauthorized read a...
CD16_00_002000: true
# CD16-00-002100 - The audit information produced by PostgreSQL must be protected from unauthorized modifi...
CD16_00_002100: true
# CD16-00-002200 - The audit information produced by PostgreSQL must be protected from unauthorized deletion.
CD16_00_002200: true
# CD16-00-002300 - PostgreSQL must protect its audit features from unauthorized access.
CD16_00_002300: true
# CD16-00-002400 - PostgreSQL must protect its audit configuration from unauthorized modification.
CD16_00_002400: true
# CD16-00-002500 - PostgreSQL must protect its audit features from unauthorized removal.
CD16_00_002500: true
# CD16-00-002600 - PostgreSQL must limit privileges to change software modules, to include stored procedur...
CD16_00_002600: true

# --- CAT I Rules ---
# CD16-00-002700 - The PostgreSQL software installation account must be restricted to authorized users.
CD16_00_002700: true

# --- CAT II Rules ---
# CD16-00-002800 - Database software, including PostgreSQL configuration files, must be stored in dedicate...
CD16_00_002800: true
# CD16-00-002900 - Database objects (including but not limited to tables, indexes, storage, stored procedu...
CD16_00_002900: true
# CD16-00-003000 - The role(s)/group(s) used to modify database structure (including but not necessarily l...
CD16_00_003000: true
# CD16-00-003200 - Unused database components, PostgreSQL software, and database objects must be removed.
CD16_00_003200: true
# CD16-00-003300 - Unused database components that are integrated in PostgreSQL and cannot be uninstalled ...
CD16_00_003300: true
# CD16-00-003400 - Access to external executables must be disabled or restricted.
CD16_00_003400: true
# CD16-00-003500 - PostgreSQL must be configured to prohibit or restrict the use of organization-defined f...
CD16_00_003500: true
# CD16-00-003600 - PostgreSQL must uniquely identify and authenticate organizational users (or processes a...
CD16_00_003600: true

# --- CAT I Rules ---
# CD16-00-003800 - If passwords are used for authentication, PostgreSQL must store only hashed, salted rep...
CD16_00_003800: true
# CD16-00-003900 - If passwords are used for authentication, PostgreSQL must transmit only encrypted repre...
CD16_00_003900: true

# --- CAT II Rules ---
# CD16-00-004000 - PostgreSQL, when using PKI-based authentication, must validate certificates by performi...
CD16_00_004000: true

# --- CAT I Rules ---
# CD16-00-004100 - PostgreSQL must enforce authorized access to all PKI private keys stored/used by Postgr...
CD16_00_004100: true

# --- CAT II Rules ---
# CD16-00-004200 - PostgreSQL must map the PKI-authenticated identity to an associated user account.
CD16_00_004200: true

# --- CAT I Rules ---
# CD16-00-004400 - PostgreSQL must use NIST FIPS 140-2 or 140-3 validated cryptographic modules for crypto...
CD16_00_004400: true

# --- CAT II Rules ---
# CD16-00-004500 - PostgreSQL must uniquely identify and authenticate nonorganizational users (or processe...
CD16_00_004500: true
# CD16-00-004600 - PostgreSQL must separate user functionality (including user interface services) from da...
CD16_00_004600: true
# CD16-00-004700 - PostgreSQL must invalidate session identifiers upon user logout or other session termin...
CD16_00_004700: true
# CD16-00-004900 - PostgreSQL must maintain the authenticity of communications sessions by guarding agains...
CD16_00_004900: true

# --- CAT I Rules ---
# CD16-00-005200 - PostgreSQL must protect the confidentiality and integrity of all information at rest.
CD16_00_005200: true

# --- CAT II Rules ---
# CD16-00-005300 - PostgreSQL must isolate security functions from nonsecurity functions.
CD16_00_005300: true
# CD16-00-005400 - Database contents must be protected from unauthorized and unintended information transf...
CD16_00_005400: true
# CD16-00-005600 - Access to database files must be limited to relevant processes and to authorized, admin...
CD16_00_005600: true
# CD16-00-005700 - PostgreSQL must check the validity of all data inputs except those specifically identif...
CD16_00_005700: true
# CD16-00-005800 - PostgreSQL and associated applications must reserve the use of dynamic code execution f...
CD16_00_005800: true
# CD16-00-005900 - PostgreSQL and associated applications, when making use of dynamic code execution, must...
CD16_00_005900: true
# CD16-00-006000 - PostgreSQL must provide nonprivileged users with error messages that provide informatio...
CD16_00_006000: true
# CD16-00-006100 - PostgreSQL must reveal detailed error messages only to the information system security ...
CD16_00_006100: true
# CD16-00-006200 - PostgreSQL must automatically terminate a user session after organization-defined condi...
CD16_00_006200: true
# CD16-00-006400 - PostgreSQL must associate organization-defined types of security labels having organiza...
CD16_00_006400: true
# CD16-00-006500 - PostgreSQL must associate organization-defined types of security labels having organiza...
CD16_00_006500: true
# CD16-00-006600 - PostgreSQL must associate organization-defined types of security labels having organiza...
CD16_00_006600: true
# CD16-00-006700 - PostgreSQL must enforce discretionary access control policies, as defined by the data o...
CD16_00_006700: true
# CD16-00-006800 - PostgreSQL must prevent nonprivileged users from executing privileged functions, to inc...
CD16_00_006800: true
# CD16-00-006900 - Execution of software modules (to include stored procedures, functions, and triggers) w...
CD16_00_006900: true
# CD16-00-007000 - PostgreSQL must use centralized management of the content captured in audit records gen...
CD16_00_007000: true
# CD16-00-007200 - PostgreSQL must allocate audit record storage capacity in accordance with organization-...
CD16_00_007200: true
# CD16-00-007300 - PostgreSQL must provide a warning to appropriate support staff when allocated audit rec...
CD16_00_007300: true
# CD16-00-007400 - PostgreSQL must provide an immediate real-time alert to appropriate support staff of al...
CD16_00_007400: true
# CD16-00-007500 - PostgreSQL must record time stamps in audit records and application data that can be ma...
CD16_00_007500: true
# CD16-00-007600 - PostgreSQL must generate time stamps for audit records and application data with a mini...
CD16_00_007600: true
# CD16-00-007700 - PostgreSQL must prohibit user installation of logic modules (stored procedures, functio...
CD16_00_007700: true
# CD16-00-007800 - PostgreSQL must enforce access restrictions associated with changes to the configuratio...
CD16_00_007800: true
# CD16-00-007900 - PostgreSQL must produce audit records of its enforcement of access restrictions associa...
CD16_00_007900: true
# CD16-00-008000 - PostgreSQL must disable network functions, ports, protocols, and services deemed by the...
CD16_00_008000: true
# CD16-00-008100 - PostgreSQL must require users to reauthenticate when organization-defined circumstances...
CD16_00_008100: true

# --- CAT I Rules ---
# CD16-00-008300 - PostgreSQL must use NSA-approved cryptography to protect classified information in acco...
CD16_00_008300: true

# --- CAT II Rules ---
# CD16-00-008400 - PostgreSQL must only accept end entity certificates issued by DOD PKI or DOD-approved P...
CD16_00_008400: true
# CD16-00-008500 - PostgreSQL must implement cryptographic mechanisms to prevent unauthorized modification...
CD16_00_008500: true
# CD16-00-008600 - PostgreSQL must implement cryptographic mechanisms preventing the unauthorized disclosu...
CD16_00_008600: true
# CD16-00-008800 - PostgreSQL must maintain the confidentiality and integrity of information during prepar...
CD16_00_008800: true
# CD16-00-008900 - PostgreSQL must maintain the confidentiality and integrity of information during recept...
CD16_00_008900: true
# CD16-00-009000 - When invalid inputs are received, PostgreSQL must behave in a predictable and documente...
CD16_00_009000: true
# CD16-00-009100 - When updates are applied to the PostgreSQL software, any software components that have ...
CD16_00_009100: true
# CD16-00-009200 - Security-relevant software updates to PostgreSQL must be installed within the time peri...
CD16_00_009200: true

# --- CAT I Rules ---
# CD16-00-009300 - PostgreSQL products must be a version supported by the vendor.
CD16_00_009300: true

# --- CAT II Rules ---
# CD16-00-009400 - PostgreSQL must be able to generate audit records when security objects are accessed.
CD16_00_009400: true
# CD16-00-009500 - PostgreSQL must generate audit records when unsuccessful attempts to access security ob...
CD16_00_009500: true
# CD16-00-009600 - PostgreSQL must generate audit records when categories of information (e.g., classifica...
CD16_00_009600: true
# CD16-00-009700 - PostgreSQL must generate audit records when unsuccessful attempts to access categories ...
CD16_00_009700: true
# CD16-00-009800 - PostgreSQL must generate audit records when privileges/permissions are added.
CD16_00_009800: true
# CD16-00-009900 - PostgreSQL must generate audit records when unsuccessful attempts to add privileges/per...
CD16_00_009900: true
# CD16-00-010000 - PostgreSQL must generate audit records when privileges/permissions are modified.
CD16_00_010000: true
# CD16-00-010100 - PostgreSQL must generate audit records when unsuccessful attempts to modify privileges/...
CD16_00_010100: true
# CD16-00-010200 - PostgreSQL must generate audit records when security objects are modified.
CD16_00_010200: true
# CD16-00-010300 - PostgreSQL must generate audit records when unsuccessful attempts to modify security ob...
CD16_00_010300: true
# CD16-00-010400 - PostgreSQL must generate audit records when categories of information (e.g., classifica...
CD16_00_010400: true
# CD16-00-010500 - PostgreSQL must generate audit records when unsuccessful attempts to modify categories ...
CD16_00_010500: true
# CD16-00-010600 - PostgreSQL must generate audit records when privileges/permissions are deleted.
CD16_00_010600: true
# CD16-00-010700 - PostgreSQL must generate audit records when unsuccessful attempts to delete privileges/...
CD16_00_010700: true
# CD16-00-010800 - PostgreSQL must generate audit records when security objects are deleted.
CD16_00_010800: true
# CD16-00-010900 - PostgreSQL must generate audit records when unsuccessful attempts to delete security ob...
CD16_00_010900: true
# CD16-00-011000 - PostgreSQL must generate audit records when categories of information (e.g., classifica...
CD16_00_011000: true
# CD16-00-011100 - PostgreSQL must generate audit records when unsuccessful attempts to delete categories ...
CD16_00_011100: true
# CD16-00-011200 - PostgreSQL must generate audit records when successful logons or connections occur.
CD16_00_011200: true
# CD16-00-011300 - PostgreSQL must generate audit records when unsuccessful logons or connection attempts ...
CD16_00_011300: true
# CD16-00-011400 - PostgreSQL must generate audit records for all privileged activities or other system-le...
CD16_00_011400: true
# CD16-00-011500 - PostgreSQL must generate audit records when unsuccessful attempts to execute privileged...
CD16_00_011500: true
# CD16-00-011600 - PostgreSQL must generate audit records showing starting and ending time for user access...
CD16_00_011600: true
# CD16-00-011700 - PostgreSQL must generate audit records when concurrent logons/connections by the same u...
CD16_00_011700: true
# CD16-00-011800 - PostgreSQL must be able to generate audit records when successful accesses to objects o...
CD16_00_011800: true
# CD16-00-011900 - PostgreSQL must generate audit records when unsuccessful accesses to objects occur.
CD16_00_011900: true
# CD16-00-012000 - PostgreSQL must generate audit records for all direct access to the database(s).
CD16_00_012000: true
# CD16-00-012200 - PostgreSQL must implement NIST FIPS 140-2 or 140-3 validated cryptographic modules to g...
CD16_00_012200: true
# CD16-00-012300 - PostgreSQL must implement NIST FIPS 140-2 or 140-3 validated cryptographic modules to p...
CD16_00_012300: true
# CD16-00-012400 - PostgreSQL must offload audit data to a separate log management facility; this must be ...
CD16_00_012400: true
